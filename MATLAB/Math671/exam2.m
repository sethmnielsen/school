A = [1 2 3; 2 4 2; 3 6 7; 4 8 9];
B = [1 1 1 3; 1 1 1 2; 1 1 1 7];

PA = zeros(3);
PA(2,1) = 1;
PA(3,2) = 1;
PA(1,3) = 1;

PB = zeros(4);
PB(3,1) = 1;
PB(4,2) = 1;
PB(1,3) = 1;
PB(2,4) = 1;

[QA, RA] = qr(A*PA);
[QB, RB] = qr(B*PB);

Q1 = QA(:,1:2);
Q2 = QA(:,3:4);
R1 = Q1' * A(:,1:2);
R2 = Q1' * A(:,3);
% R1 = RA(1:2,1:2);
% R2 = RA(1:2,3);

Q1B = QB(:,1:2);
Q2B = QB(:,3);
R1B = Q1B' * B(:,1:2);
R2B = Q1B' * B(:,3:4);

Qa = [Q1 Q2];
Qb = [Q1B Q2B];
Ra = [R1 R2; 0 0 0; 0 0 0]
Rb = [R1B R2B; 0 0 0 0];

Qa * Ra
